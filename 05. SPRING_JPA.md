## JPA

<details>
    <summary><b>JDBC, Spring JDBC</b></summary>

## 정리
### JDBC 란?
- 자바의 데이터 액세스 기술의 기본이 되는 로우 레벨 API 이다.
- 표준 인터페이스를 제공하고 여러 DB 벤더가 해당 인터페이스를 구현한 드라이버를 제공한다.
- 문제점
  - 쿼리를 실행하기 위해 많은 코드를 작성해야 한다.
  - DB 에 따라 정보가 달라져, 일관성이 없는 체크 예외가 발생한다.
- 장점
  - 표준화된 방식으로 데이터 액세스를 할 수 있다.
  - 러닝 커브가 크지 않다.
#### 실행 과정
1. Connection 을 가져온다.
2. SQL 을 담은 Statement(또는 PreparedStatement) 를 만든다.
3. Statement 를 실행한다.
4. Result 를 받아 객체로 옮긴다.
5. Connection, Statement, ResultSet 등 사용하지 않는 리소스를 해제한다.
6. JDBC API 가 만드는 예외를 처리한다.
### Spring JDBC 란?
- JDBC 의 장점과 단순성은 유지하고 문제를 해결하여 편리하게 사용할 수 있게 만든 API
#### DB 접근 방법
- JdbcTemplate
  - 가장 클래식하고 기본인 접근 방식
- NamedParameterJdbcTemplate
  - `?` 로 파라미터를 매핑하는 것 대신 이름으로 매핑
  - 파라미터가 여러 개 있을 때 유리하다.
- SimpleJdbcInsert, SimpleJdbcCall
  - DB 가 제공해주는 메타 데이터를 이용하여 코드 작성을 최소화해준다.
  - 메타 데이터에서 컬럼 정보와 파라미터 정보를 가져와서 삽입용 SQL 과 프로시저를 호출하기 때문에 편리하다.
  - 메타데이터를 제공하지 않는 DB 에서는 사용할 수 없다.
#### 제공하는 편의 기능
- Connection 열기와 닫기: 트랜잭션과 연계되어 커넥션 관리를 해준다.
- Statement 준비와 닫기
- Statement 실행
- ResultSet Loop 처리
- Exception 처리와 반환: CheckedException 인 SQLException 을 DataAccessException 으로 변환한다.
- Transaction 처리
## 참조
- https://docs.spring.io/spring-framework/reference/data-access/jdbc/choose-style.html
</details>

<details>
    <summary><b>Connection Pool</b></summary>

## 정리
### Connection 이란?
- DB 를 사용하기 위해 DB 와 애플리케이션 간 통신을 할 수 있는 수단
### Connection Pool 이란?
- Connection 객체들을 모아둔 공간
- 사용자의 요청이 올 때마다 Connection 을 생성하고 끊는 작업은 매우 비효율적이므로 Connection Pool 을 사용한다.
## 참조

</details>

<details>
    <summary><b>DataSource</b></summary>

## 정리
### 
### DBCP
- WAS 가 실행되면서 일정량의 Connection 객체를 미리 만들어서 Pool 에 저장했다가, 클라이언트 요청이 오면 Connection 객체를 빌려주고 해당 객체의 임무가 완료되면 다시 Connection 객체를 반납받아서 Pool 에 저장하는 프로그래밍 기법
### 장점
- DB 접속 설정 객체를 미리 만들어 메모리에 등록하기 때문에 생성, 삭제 작업이 사라지므로 효율적이다.
- DB Connection 수를 제한할 수 있어 과도한 접속으로 인한 서버 자원 고갈 방지가 가능하다.
- DB 접속 모듈을 공통화하여 DB 서버 환경이 바뀔경우 대처가 쉽다.
### 고려할 점
- 동시 접속자가 많을 경우
  - Connection 은 한정되어 있으므로 사용할 수 있는 Connection 객체가 반납될 때까지 대기해야 한다.
  - 이를 위해 Connection 의 제한을 크게 잡으면 사용자의 대기 시간은 줄어들지만, 메모리 소모가 크고,
  - 작게 잡으면 대기 시간이 길어진다.
- Connection Pool 이 커지게 되면?
  - 하나의 Connection 은 하나의 Thread 가 담당한다. 따라서 Thread Pool 과 Connection Pool 의 크기를 적절히 조절해야 한다.
  - Thread Pool <<< Connection Pool 인 경우 (Connection Pool 만 크기 증가)
    - 놀게 되는 Connection 이 많아지므로 효율적인 메모리 사용이 아니다.
  - Thread Pool, Connection Pool 둘 다 크기 증가인 경우
    - 노는 Connection 이 많아져 Thread 를 추가하게 되면 다음의 문제가 발생할 수 있다.
    - Thread 증가로 인해 Context Switching 이 발생한다.
    - Disk 경합 측면에서 성능 한계가 발생한다.
      - DB 는 하드디스크 하나 당 하나의 I/O 를 처리하기 때문에 병목이 발생할 수 있다.
- 적당한 Connection Pool 의 크기는? (Hikari CP)
  - Hikari CP 위키를 보면 다음 공식을 제안한다.
  - `Pool Size = Tn * (Cm - 1) + 1`
  - Tn: 전체 Thread 갯수
  - Cm: 하나의 Task 에서 동시에 필요한 Connection 수
### Hikari CP 란?
- 스프링 부터 2.0 버전부터 기본으로 사용하는 DBCP 이다.
- 장점
  - 적은 메모리 사용량
  - 높은 처리량
  - 작은 코드 베이스
  - 풍부한 구성 옵션
  - 스레드 안정성
- 설정 옵션
  - minimum-idle: Connection Pool 에 유지 가능한 최소 커넥션 개수
  - maximum-pool-size: Connection Pool 에 유지 가능한 최대 커넥션 개수
  - idle-timeout: Connection 이 Pool 에서 유휴상태(사용하지 않는 상태)로 남을 수 있는 최대 시간
  - pool-name: Connection Pool 이름
  - max-lifetime: Connection 의 최대 유지 가능 시간
  - connection-timeout: Pool 에서 Connection 을 구할 때 대기시간, 대기시간안에 구하지 못하면 Exception
  - connection-test-query: Connection 이 잘 되었는지 확인하는 TEST SQL
## 참조
- https://techblog.woowahan.com/2663/
- https://steady-coding.tistory.com/564
- https://dkswnkk.tistory.com/685
</details>

---

<details>
    <summary><b>Sql Mapper(MyBatis)</b></summary>

## 정리
### SQL Mapper 란?
- 객체와 관계형 데이터베이스의 데이터를 개발자가 작성한 SQL 로 매핑시켜주는 프레임워크
### 장단점
- 장점
  - JDBC 를 사용하는 것에 비해 코드 작성이 간편하다.
  - XML 을 통해 관리하기 때문에 변경에 용이하고 유지보수가 편하다.
- 단점
  - DBMS 에 따라 SQL 문법이 다르기 때문에 이에 종속적이다.
  - SQL 을 직접 작성해야 한다.
  - 객체 모델과 관계 모델을 따로 관리해야 한다. 
## 참조

</details>

---

<details>
    <summary><b>JPA, Hibernate</b></summary>
</details>

<details>
    <summary><b>ORM</b></summary>
</details>

---

<details>
    <summary><b>영속성 컨텍스트</b></summary>
</details>

<details>
    <summary><b>OSIV</b></summary>
</details>

---